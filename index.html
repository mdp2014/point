<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scores baby fooooooot !!!</title>
<style>
  /* ===== ARRIÈRE-PLAN ANIMÉ SUBTIL ===== */
  body {
    position: relative;
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0;
    min-height: 100vh;
    background: linear-gradient(120deg, #e0e7ff 0%, #b2f7ef 100%);
    overflow-x: hidden;
    color: #1e3a8a;
  }
  body::before {
    content: "";
    position: fixed;
    top: 0; left: -40%;
    width: 180%;
    height: 100%;
    pointer-events: none;
    background: linear-gradient(
      120deg,
      rgba(255 255 255 / 0.04) 0%,
      rgba(255 255 255 / 0.12) 50%,
      rgba(255 255 255 / 0.04) 100%
    );
    animation: subtleGradientShift 40s linear infinite;
    z-index: 0;
    mix-blend-mode: screen;
  }
  @keyframes subtleGradientShift {
    0% { transform: translateX(0); }
    100% { transform: translateX(-40%); }
  }

  /* ===== TITRE ===== */
  h1 {
    margin: 40px auto 20px auto;
    text-align: center;
    font-size: 2.8rem;
    letter-spacing: 3px;
    font-weight: 700;
    text-shadow: 0 1px 3px rgba(0,0,0,0.1);
    position: relative;
    z-index: 1;
  }

  /* ===== TIMER ===== */
  .timer-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 25px 0 20px;
    position: relative;
    z-index: 1;
  }
  .timer-slider-label {
    font-size: 1.15rem;
    color: #2563eb;
    margin-bottom: 8px;
    font-weight: 600;
  }
  .timer-slider {
    width: 240px;
    accent-color: #3b82f6;
    cursor: pointer;
    border-radius: 8px;
  }
  .timer-controls {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-top: 14px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .timer-btn {
    border: none;
    background: #3b82f6;
    color: #fff;
    border-radius: 50%;
    width: 46px;
    height: 46px;
    font-size: 1.3rem;
    font-weight: 700;
    margin: 0 7px;
    cursor: pointer;
    box-shadow: 0 3px 10px rgba(59,130,246,0.4);
    transition: background 0.2s, transform 0.15s;
    outline: none;
    user-select: none;
  }
  .timer-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background: #a5b4fc;
    box-shadow: none;
  }
  .timer-btn:hover:not(:disabled) {
    background: #2563eb;
    transform: scale(1.1);
  }
  #timerDisplay {
    font-size: 2.6rem;
    font-weight: 700;
    letter-spacing: 2px;
    min-width: 120px;
    text-align: center;
    background: #dbeafe;
    border-radius: 12px;
    padding: 10px 28px;
    box-shadow: 0 3px 12px rgba(96,165,250,0.25);
    border: 2.5px solid #3b82f6;
    user-select: none;
  }
  #timerEndMsg {
    width: 100%;
    text-align: center;
    font-size: 1.7rem;
    font-weight: 700;
    color: #dc2626;
    text-shadow: 0 3px 18px rgba(248,113,113,0.75);
    animation: timerPulse 1.3s infinite alternate;
    margin-bottom: 12px;
    letter-spacing: 2px;
    position: relative;
    z-index: 1;
  }
  @keyframes timerPulse {
    0% { color: #f87171; transform: scale(1); }
    100% { color: #b91c1c; transform: scale(1.15); }
  }
  .test-sound-btn {
    background: #10b981;
    border-radius: 24px;
    padding: 8px 18px;
    font-size: 1.1rem;
    color: #fff;
    border: none;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 2px 8px rgba(16,185,129,0.5);
    transition: background 0.18s;
    white-space: nowrap;
  }
  .test-sound-btn:hover {
    background: #059669;
  }

  /* ===== TABLEAU ===== */
  table {
    width: 90%;
    max-width: 900px;
    margin: 30px auto 50px;
    border-collapse: collapse;
    background: rgba(255,255,255,0.95);
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 10px 38px -10px rgba(79,70,229,0.3);
    position: relative;
    z-index: 1;
  }
  th, td {
    padding: 20px 14px;
    border-bottom: 1px solid #e5e7eb;
    text-align: center;
    font-size: 1.2rem;
  }
  th {
    background: linear-gradient(90deg, #3b82f6 60%, #38bdf8 100%);
    color: #fff;
    font-weight: 700;
    letter-spacing: 1.2px;
  }
  tr:last-child td {
    border-bottom: none;
  }

  /* ===== BOUTONS ===== */
  button {
    padding: 12px 22px;
    font-size: 1rem;
    background-color: #3b82f6;
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin: 3px 4px;
    font-weight: 600;
    transition: background 0.18s, transform 0.12s;
    box-shadow: 0 3px 10px rgba(0,0,0,0.12);
    user-select: none;
    white-space: nowrap;
  }
  button:hover {
    background-color: #2563eb;
    transform: translateY(-2px) scale(1.06);
  }
  .btn-danger {
    background: #ef4444;
  }
  .btn-danger:hover {
    background: #b91c1c;
  }

  /* ===== FORM AJOUT JOUEUR ===== */
  .ajoutjoueur {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 50px;
    gap: 14px;
    position: relative;
    z-index: 1;
    flex-wrap: wrap;
  }
  #playerName {
    border: 2px solid #60a5fa;
    border-radius: 12px;
    padding: 14px;
    font-size: 1.25rem;
    width: 320px;
    max-width: 95vw;
    background-color: #f1f5f9;
    color: #111827;
    box-shadow: 1px 3px 10px rgba(79,70,229,0.15);
    outline: none;
    transition: border-color 0.3s, box-shadow 0.3s;
  }
  #playerName:focus {
    border-color: #2563eb;
    box-shadow: 0 0 12px 3px rgba(59,130,246,0.45);
    background: #fff;
  }

  /* ===== SCORES COULEURS ===== */
  .score-negative {
    color: #ef4444;
    font-weight: 700;
  }
  .score-positive {
    color: #059669;
    font-weight: 700;
  }
  .score-zero {
    color: #64748b;
  }

  /* ===== POPUP SELECT PLAYER ===== */
  .overlay-popup {
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.35);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }
  .popup-select-player {
    background: #fff;
    padding: 30px 24px 22px;
    border-radius: 14px;
    box-shadow: 0 6px 28px rgba(0,0,0,0.22);
    text-align: center;
    min-width: 260px;
    max-width: 90vw;
    user-select: none;
  }
  .popup-select-player .popup-title {
    font-weight: 700;
    margin-bottom: 18px;
    font-size: 1.2rem;
    color: #2563eb;
  }
  .popup-select-player button {
    margin: 8px 6px;
    padding: 10px 18px;
    font-weight: 600;
    border-radius: 10px;
  }
  .popup-select-player .cancel-btn {
    background: #ddd;
    color: #222;
    margin-top: 22px;
    box-shadow: none;
  }
  .popup-select-player .cancel-btn:hover {
    background: #bbb;
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 600px) {
    table, .ajoutjoueur {
      width: 98%;
      flex-direction: column;
      margin: 20px auto 40px;
    }
    #playerName {
      width: 100%;
      font-size: 1.15rem;
    }
    .timer-controls {
      flex-direction: column;
      gap: 10px;
    }
    .timer-slider {
      width: 95vw;
      max-width: none;
    }
  }
</style>
</head>
<body>

  <!-- TIMER -->
  <div class="timer-container">
    <div class="timer-slider-label">
      Durée du match : <span id="sliderValue">10</span> min
    </div>
    <input type="range" min="1" max="60" value="10" class="timer-slider" id="timerSlider" />
    <div class="timer-controls">
      <button class="timer-btn" id="startTimer" title="Démarrer">&#9658;</button>
      <button class="timer-btn" id="pauseTimer" title="Pause" disabled>&#10073;&#10073;</button>
      <button class="timer-btn" id="resetTimer" title="Réinitialiser" disabled>&#8635;</button>
      <span id="timerDisplay">10:00</span>
      <button class="test-sound-btn" id="testSoundBtn" title="Tester le son">🔊 Tester le son</button>
    </div>
    <div id="timerEndMsg" style="display:none;"></div>
    <audio id="timerSound">
      <source src="https://cdn.pixabay.com/audio/2022/10/16/audio_12b5b3b2e9.mp3" type="audio/mp3" />
    </audio>
  </div>

  <h1>Tableau des scores</h1>

  <table>
    <thead>
      <tr>
        <th>Joueur</th>
        <th>Points</th>
        <th>Paniers / Actions</th>
      </tr>
    </thead>
    <tbody id="players"></tbody>
  </table>

  <div class="ajoutjoueur">
    <input type="text" id="playerName" placeholder="Ajouter un joueur" />
    <button id="addButton">Ajouter</button>
  </div>

  <script>
    // --- TIMER MATCH ---
    let timerInterval = null;
    let timerTimeLeft = 600; // secondes (10 min initial)
    let timerRunning = false;
    let timerDuration = 10; // minutes

    const timerSlider = document.getElementById("timerSlider");
    const sliderValue = document.getElementById("sliderValue");
    const timerDisplay = document.getElementById("timerDisplay");
    const timerEndMsg = document.getElementById("timerEndMsg");
    const startBtn = document.getElementById("startTimer");
    const pauseBtn = document.getElementById("pauseTimer");
    const resetBtn = document.getElementById("resetTimer");
    const timerSound = document.getElementById("timerSound");
    const testSoundBtn = document.getElementById("testSoundBtn");

    timerSlider.addEventListener("input", () => {
      sliderValue.textContent = timerSlider.value;
      if (!timerRunning) {
        timerDuration = parseInt(timerSlider.value, 10);
        timerTimeLeft = timerDuration * 60;
        updateTimerDisplay();
      }
    });

    function updateTimerDisplay() {
      const min = Math.floor(timerTimeLeft / 60);
      const sec = timerTimeLeft % 60;
      timerDisplay.textContent = `${min.toString().padStart(2, "0")}:${sec.toString().padStart(2, "0")}`;
    }

    function startTimer() {
      if (timerRunning) return;
      timerRunning = true;
      startBtn.disabled = true;
      pauseBtn.disabled = false;
      resetBtn.disabled = false;
      timerEndMsg.style.display = "none";
      timerEndMsg.textContent = "";
      timerInterval = setInterval(() => {
        if (timerTimeLeft > 0) {
          timerTimeLeft--;
          updateTimerDisplay();
          if (timerTimeLeft === 0) {
            clearInterval(timerInterval);
            timerRunning = false;
            startBtn.disabled = true;
            pauseBtn.disabled = true;
            timerEndMsg.textContent = "⏰ TEMPS ÉCOULÉ !";
            timerEndMsg.style.display = "block";
            timerSound.pause();
            timerSound.currentTime = 0;
            timerSound.play().catch(() => {});
          }
        }
      }, 1000);
    }

    function pauseTimer() {
      if (!timerRunning) return;
      clearInterval(timerInterval);
      timerRunning = false;
      startBtn.disabled = false;
      pauseBtn.disabled = true;
    }

    function resetTimer() {
      clearInterval(timerInterval);
      timerRunning = false;
      timerDuration = parseInt(timerSlider.value, 10);
      timerTimeLeft = timerDuration * 60;
      updateTimerDisplay();
      startBtn.disabled = false;
      pauseBtn.disabled = true;
      resetBtn.disabled = true;
      timerEndMsg.style.display = "none";
      timerEndMsg.textContent = "";
    }

    function initTimer() {
      startBtn.addEventListener("click", startTimer);
      pauseBtn.addEventListener("click", pauseTimer);
      resetBtn.addEventListener("click", resetTimer);
      testSoundBtn.addEventListener("click", () => {
        timerSound.pause();
        timerSound.currentTime = 0;
        timerSound.play();
      });
      sliderValue.textContent = timerSlider.value;
      timerDuration = parseInt(timerSlider.value, 10);
      timerTimeLeft = timerDuration * 60;
      updateTimerDisplay();
      timerEndMsg.style.display = "none";
    }
    initTimer();

    // --- SCORE TABLE ---
    let players = [];
    const playerNameInput = document.getElementById("playerName");
    const addButton = document.getElementById("addButton");

    playerNameInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") addPlayer();
    });
    addButton.addEventListener("click", addPlayer);

    function addPlayer() {
      const playerName = playerNameInput.value.trim();
      if (playerName === "") return;
      players.push({ name: playerName, score: 0 });
      playerNameInput.value = "";
      updateTable();
    }

    function deletePlayer(index) {
      players.splice(index, 1);
      updateTable();
    }

    function getScoreClass(score) {
      if (score < 0) return "score-negative";
      if (score > 0) return "score-positive";
      return "score-zero";
    }

    function updateTable() {
      const tableBody = document.getElementById("players");
      tableBody.innerHTML = "";

      players.forEach((player, index) => {
        const row = document.createElement("tr");

        const nameCell = document.createElement("td");
        nameCell.textContent = player.name;

        const scoreCell = document.createElement("td");
        scoreCell.textContent = player.score;
        scoreCell.className = getScoreClass(player.score);

        const actionsCell = document.createElement("td");

        ["+1", "+2", "+3"].forEach((txt, i) => {
          const btn = document.createElement("button");
          btn.textContent = txt;
          btn.title = `Ajouter ${txt.replace("+","")} point${txt === "+1" ? "" : "s"}`;
          btn.addEventListener("click", () => {
            player.score += parseInt(txt);
            updateTable();
          });
          actionsCell.appendChild(btn);
        });

        const minus1Button = document.createElement("button");
        minus1Button.textContent = "-1";
        minus1Button.title = "Retirer 1 point";
        minus1Button.addEventListener("click", () => {
          player.score -= 1;
          updateTable();
        });
        actionsCell.appendChild(minus1Button);

        const addFromOtherButton = document.createElement("button");
        addFromOtherButton.textContent = "+ d'un autre";
        addFromOtherButton.title = "Ajouter un point en provenance d'un autre joueur";
        addFromOtherButton.addEventListener("click", () => {
          showPlayerSelectPopup(index);
        });
        actionsCell.appendChild(addFromOtherButton);

        const deleteButton = document.createElement("button");
        deleteButton.textContent = "X";
        deleteButton.title = "Supprimer le joueur";
        deleteButton.className = "btn-danger";
        deleteButton.addEventListener("click", () => {
          if (confirm(`Supprimer ${player.name} ?`)) {
            deletePlayer(index);
          }
        });
        actionsCell.appendChild(deleteButton);

        row.appendChild(nameCell);
        row.appendChild(scoreCell);
        row.appendChild(actionsCell);

        tableBody.appendChild(row);
      });
    }

    // --- POPUP POUR CHOISIR LE JOUEUR DONNEUR ---
    let popupOverlay = null;

    function showPlayerSelectPopup(targetIndex) {
      if (popupOverlay) return; // Déjà ouvert

      popupOverlay = document.createElement("div");
      popupOverlay.className = "overlay-popup";

      const popup = document.createElement("div");
      popup.className = "popup-select-player";

      const title = document.createElement("div");
      title.className = "popup-title";
      title.textContent = `Choisir le joueur donneur pour ${players[targetIndex].name}`;

      popup.appendChild(title);

      players.forEach((player, index) => {
        if (index === targetIndex) return; // pas soi-même
        const btn = document.createElement("button");
        btn.textContent = player.name;
        btn.title = `Retirer 1 point de ${player.name}`;
        btn.addEventListener("click", () => {
          if (players[index].score > 0) {
            players[index].score -= 1;
            players[targetIndex].score += 1;
            updateTable();
          } else {
            alert(`${players[index].name} n'a pas assez de points pour donner.`);
          }
          closePopup();
        });
        popup.appendChild(btn);
      });

      const cancelBtn = document.createElement("button");
      cancelBtn.textContent = "Annuler";
      cancelBtn.className = "cancel-btn";
      cancelBtn.addEventListener("click", closePopup);
      popup.appendChild(cancelBtn);

      popupOverlay.appendChild(popup);
      document.body.appendChild(popupOverlay);
    }

    function closePopup() {
      if (popupOverlay) {
        popupOverlay.remove();
        popupOverlay = null;
      }
    }
  </script>

</body>
</html>
